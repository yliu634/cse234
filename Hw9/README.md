**Run:**

cd Hw9

python3 main.py

The outputs show the result of each phase

ECDSA.py, sha3.py, simon.py are from the previous homeworks

Here is an example outputs:



Original message:

b'Hello'

key pair of Alice:

74216847555731271918846696077494490162505548417817815199417061405398048363687 
[6674323133890476182498702802924136367776997094048798382043482361871257961379616886980451105021998209703026731114515410884242627322544652753639054990860817079
 3858195318506320256161385147483115675430953107616430400277950840902191741356491821889850294632793836830972103665136184294333506202515176446134544064532817010]

key pair of Bob:

21033336562907726295974285822336725949182671860114102923401057719583645394272 
[106332950989400925106615704036547599469617894108336473350140566201923059598549322519183049014161055579840063727727568244968074133225584295250900020910420272
 386750785197846188357015182711759124873772737649782160583036669094336182158946998352925021985559402473675603092243519306448483769756293994983646084246098306]


------------------Alice Part:------------------

Next key pair of Alice:

21439501275660943057150052854921622913285424392989712044539125538485655299280 [6310904763541059686499587419275512832755694345528203075861734874901022247634619246708253334816105997407293281096180185770552450114749942222312209522646399744
 316300040353993806745830596410022316597858753961294912055624513170481120138251973290150256372956704093210203995733355434442713608883313619812131586390740170]

After point compression:

01d6b053eaff5ea2a523c48a99537c7691fd09cd4b944750b5fd817fea797a5dec08f2dcb337e91fc203ae3058207c4c01474267fb9b322df6835d2f8120534d3b00

Padded Signature:

r =  00f2ff4570a674f148c8cbbb5d57587a3a28c32d73be96829f9971341c718eefe1ccaf58c2d9c95c74e9a77f8716559d3e6e930092ec727f66748ddafc73225bff1e

s =  01b9db7790e8bea35ad81a4a92fd7d3898a44623fa08874b3d30c64bd8adb1010b4663b657574e3594dd353b4d96d119407cdc897e50c23649d6bdab997fd597e82e

Assembled signature, next key, and message:

00f2ff4570a674f148c8cbbb5d57587a3a28c32d73be96829f9971341c718eefe1ccaf58c2d9c95c74e9a77f8716559d3e6e930092ec727f66748ddafc73225bff1e01b9db7790e8bea35ad81a4a92fd7d3898a44623fa08874b3d30c64bd8adb1010b4663b657574e3594dd353b4d96d119407cdc897e50c23649d6bdab997fd597e82e01d6b053eaff5ea2a523c48a99537c7691fd09cd4b944750b5fd817fea797a5dec08f2dcb337e91fc203ae3058207c4c01474267fb9b322df6835d2f8120534d3b0048656c6c6f

transient key pair:

82375419276732181388645254141115879530423851488930183929972757500693183362757 [608426222544580214981551993380166560419261583915839696691361442407788356732240574672613422604628177149373854751501165514254492607826661370996834539847029143
 6216382629139959883906097561365134844217460136696106933253304987065306365441321229041220055729392712934167231149961706570015984325459184719303225837022927838]

The ephemeral public key after compression X(x) is:

022d60e56d439e52fc890cd1c55b586bc439caadcbc26cbfba8fa76be67fad25bf7282c195b9bf9c3873f2f380f236bd3f78139d530ec3c9b95924d0c32ddb141197

After Simon cipher:

586e1957691289c38278be8715d5e819b9d6d9bd82d1d19285931b35df2902c548872340b1e039b4facbda3d4595ae44a900587445247aeb52716c19157530aafef81d20a33a8d20ef34bc1deb5d3b9ea0da36f2e2617924b7de2216c382259a3b203671b6691a4d72677dc2e1c774271a590feecd85a362157e368a9d3456a4d0eb2f23e6dad83b4e2314fa93616c3a20a98109af6da8e485807ee883c2682ed42c6c14def30affaae3c865384c919ccb51effc679e693ee0b9ee927ef0ab37c8f1edd247edb1ac51eb715caa136aed

Final send message: 

022d60e56d439e52fc890cd1c55b586bc439caadcbc26cbfba8fa76be67fad25bf7282c195b9bf9c3873f2f380f236bd3f78139d530ec3c9b95924d0c32ddb1411971289c38278be8715d5e819b9d6d9bd82d1d19285931b35df2902c548872340b1e039b4facbda3d4595ae44a900587445247aeb52716c19157530aafef81d20a33a8d20ef34bc1deb5d3b9ea0da36f2e2617924b7de2216c382259a3b203671b6691a4d72677dc2e1c774271a590feecd85a362157e368a9d3456a4d0eb2f23e6dad83b4e2314fa93616c3a20a98109af6da8e485807ee883c2682ed42c6c14def30affaae3c865384c919ccb51effc679e693ee0b9ee927ef0ab37c8f1edd247edb1ac51eb715caa136aed


------------------Bob Part:------------------

Recovered X public key:

[608426222544580214981551993380166560419261583915839696691361442407788356732240574672613422604628177149373854751501165514254492607826661370996834539847029143
 6216382629139959883906097561365134844217460136696106933253304987065306365441321229041220055729392712934167231149961706570015984325459184719303225837022927838]

After Simon decryption:

00f2ff4570a674f148c8cbbb5d57587a3a28c32d73be96829f9971341c718eefe1ccaf58c2d9c95c74e9a77f8716559d3e6e930092ec727f66748ddafc73225bff1e01b9db7790e8bea35ad81a4a92fd7d3898a44623fa08874b3d30c64bd8adb1010b4663b657574e3594dd353b4d96d119407cdc897e50c23649d6bdab997fd597e82e01d6b053eaff5ea2a523c48a99537c7691fd09cd4b944750b5fd817fea797a5dec08f2dcb337e91fc203ae3058207c4c01474267fb9b322df6835d2f8120534d3b0048656c6c6f

After decryption:

48656c6c6f

Extracted signature:

r =  f2ff4570a674f148c8cbbb5d57587a3a28c32d73be96829f9971341c718eefe1ccaf58c2d9c95c74e9a77f8716559d3e6e930092ec727f66748ddafc73225bff1e

s =  1b9db7790e8bea35ad81a4a92fd7d3898a44623fa08874b3d30c64bd8adb1010b4663b657574e3594dd353b4d96d119407cdc897e50c23649d6bdab997fd597e82e

Decrypted original message:

Hello

Extracted next public key of Alice is: 

[6310904763541059686499587419275512832755694345528203075861734874901022247634619246708253334816105997407293281096180185770552450114749942222312209522646399744
 316300040353993806745830596410022316597858753961294912055624513170481120138251973290150256372956704093210203995733355434442713608883313619812131586390740170]

Pass the valiadation: 

True


**Key ratcheting**

The diagram is in the hw9.pdf file.
